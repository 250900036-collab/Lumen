<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LUMEN</title>

<style>
body{
margin:0;
font-family:Arial, sans-serif;
background: radial-gradient(circle at center, #6a00ff, #1a001f);
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
overflow:hidden;
}

/* Pantallas */
.screen{
display:none;
flex-direction:column;
align-items:center;
text-align:center;
width:90%;
}

.active{
display:flex;
}

/* T칤tulo brillante */
.title{
font-size:50px;
font-weight:bold;
margin-bottom:30px;
text-shadow:0 0 10px #fff, 0 0 20px #a020f0, 0 0 40px #ff00ff;
}

/* Bot칩n SOS */
#sosBtn{
width:220px;
height:220px;
border-radius:50%;
background:red;
color:white;
font-size:40px;
border:none;
box-shadow:0 0 40px red;
margin-top:20px;
}

/* Caja resaltada */
.infoBox{
margin-top:20px;
padding:15px 25px;
border:2px solid #fff;
border-radius:10px;
background:rgba(255,255,255,0.1);
font-size:18px;
}

/* Inputs */
input{
padding:10px;
margin:10px;
border-radius:8px;
border:none;
width:220px;
}

button{
padding:10px 20px;
border-radius:8px;
border:none;
margin-top:10px;
font-weight:bold;
}

video{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
object-fit:cover;
display:none;
z-index:-1;
}
</style>
</head>

<body>

<!-- INTRO -->
<div id="intro" class="screen active">
<h1 class="title">LUMEN</h1>
<p>Tu luz en momentos de emergencia.</p>
<button onclick="goToAuth()">Comenzar</button>
</div>

<!-- LOGIN / REGISTER -->
<div id="auth" class="screen">
<h2>Acceso Seguro</h2>
<input type="text" id="user" placeholder="Usuario">
<input type="password" id="pass" placeholder="Contrase침a">
<button onclick="register()">Registrarse</button>
<button onclick="login()">Iniciar Sesi칩n</button>
<p id="authMsg"></p>
</div>

<!-- APP PRINCIPAL -->
<div id="app" class="screen">
<h1 class="title">LUMEN</h1>
<button id="sosBtn">SOS</button>
<div class="infoBox">Presiona si necesitas ayuda</div>
</div>

<video id="camera" autoplay playsinline></video>

<script>
function goToAuth(){
document.getElementById("intro").classList.remove("active");
document.getElementById("auth").classList.add("active");
}

function register(){
const u = document.getElementById("user").value;
const p = document.getElementById("pass").value;

if(u && p){
localStorage.setItem("lumenUser", u);
localStorage.setItem("lumenPass", p);
document.getElementById("authMsg").innerText="Usuario creado correctamente";
}else{
document.getElementById("authMsg").innerText="Completa los campos";
}
}

function login(){
const u = document.getElementById("user").value;
const p = document.getElementById("pass").value;

if(u === localStorage.getItem("lumenUser") && 
   p === localStorage.getItem("lumenPass")){
document.getElementById("auth").classList.remove("active");
document.getElementById("app").classList.add("active");
}else{
document.getElementById("authMsg").innerText="Datos incorrectos";
}
}

/* SOS FUNCIONALIDAD */
const btn = document.getElementById("sosBtn");
const cam = document.getElementById("camera");

btn.addEventListener("click", async () => {

if(navigator.vibrate){
navigator.vibrate([500,200,500,200,1000]);
}

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
const oscillator = audioCtx.createOscillator();
const gainNode = audioCtx.createGain();

oscillator.type="sawtooth";
oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
oscillator.frequency.linearRampToValueAtTime(1400, audioCtx.currentTime + 1);

oscillator.connect(gainNode);
gainNode.connect(audioCtx.destination);
gainNode.gain.value=1;
oscillator.start();

try{
const stream = await navigator.mediaDevices.getUserMedia({video:true});
cam.srcObject = stream;
cam.style.display="block";
document.getElementById("app").style.display="none";
}catch(e){
alert("Permite acceso a la c치mara");
}

if(navigator.geolocation){
navigator.geolocation.getCurrentPosition(function(position){

const lat = position.coords.latitude;
const lon = position.coords.longitude;

const mensaje =
"游뚿 NECESITO AYUDA 游뚿\n\n" +
"Mi ubicaci칩n:\n" +
"https://maps.google.com/?q=" + lat + "," + lon;

const url = "whatsapp://send?text=" + encodeURIComponent(mensaje);

window.location.href = url;

});
}

});
</script>

</body>
</html>
