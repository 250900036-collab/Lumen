<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LUMEN</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#6a00ff">

<style>
body{
margin:0;
font-family:Arial, sans-serif;
background:#1a0033;
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
overflow:hidden;
}

.screen{
display:flex;
flex-direction:column;
align-items:center;
text-align:center;
}

.title{
font-size:50px;
text-shadow:0 0 15px #fff,0 0 30px #a020f0,0 0 50px #ff00ff;
margin-bottom:30px;
}

input{
padding:12px;
margin:8px;
border-radius:10px;
border:none;
width:230px;
outline:none;
}

button{
padding:12px 25px;
border-radius:10px;
border:none;
margin-top:10px;
font-weight:bold;
cursor:pointer;
background:#a020f0;
color:white;
}

button:hover{
opacity:0.85;
}

#sosBtn{
width:200px;
height:200px;
border-radius:50%;
background:red;
color:white;
font-size:35px;
box-shadow:0 0 40px red;
margin-top:30px;
}

.hidden{
display:none;
}
</style>
</head>

<body>

<div id="auth" class="screen">
<h1 class="title">LUMEN</h1>
<input type="text" id="user" placeholder="Usuario">
<input type="password" id="pass" placeholder="Contrase침a">
<button onclick="register()">Registrarse</button>
<button onclick="login()">Iniciar Sesi칩n</button>
<p id="msg"></p>
</div>

<div id="app" class="screen hidden">
<h1 class="title">LUMEN</h1>
<button id="sosBtn">SOS</button>
<button onclick="logout()">Cerrar sesi칩n</button>
</div>

<script>

/* VARIABLES SEGURAS PARA SAFARI */
const auth = document.getElementById("auth");
const app = document.getElementById("app");
const user = document.getElementById("user");
const pass = document.getElementById("pass");
const msg = document.getElementById("msg");
const sosBtn = document.getElementById("sosBtn");

/* SONIDO */
function clickSound(){
const audio = new Audio("https://actions.google.com/sounds/v1/cartoon/pop.ogg");
audio.play();
}

/* RECORDAR SESI칍N */
if(localStorage.getItem("lumenLogged")==="true"){
auth.classList.add("hidden");
app.classList.remove("hidden");
}

/* REGISTRO */
function register(){
clickSound();
if(user.value && pass.value){
localStorage.setItem("lumenUser",user.value);
localStorage.setItem("lumenPass",pass.value);
msg.innerText="Usuario creado correctamente";
}else{
msg.innerText="Completa los campos";
}
}

/* LOGIN */
function login(){
clickSound();
if(user.value===localStorage.getItem("lumenUser") &&
pass.value===localStorage.getItem("lumenPass")){
localStorage.setItem("lumenLogged","true");
auth.classList.add("hidden");
app.classList.remove("hidden");
}else{
msg.innerText="Datos incorrectos";
}
}

/* LOGOUT */
function logout(){
localStorage.removeItem("lumenLogged");
location.reload();
}

/* BOT칍N SOS */
sosBtn.addEventListener("click",()=>{

clickSound();

if(navigator.vibrate){
navigator.vibrate([500,200,500]);
}

navigator.geolocation.getCurrentPosition(
pos=>{
const lat=pos.coords.latitude;
const lon=pos.coords.longitude;
const mensaje="游뚿 NECESITO AYUDA 游뚿 https://maps.google.com/?q="+lat+","+lon;
window.location.href="https://wa.me/?text="+encodeURIComponent(mensaje);
},
err=>{
alert("Activa los permisos de ubicaci칩n en tu navegador.");
}
);

});

/* SERVICE WORKER */
if('serviceWorker' in navigator){
navigator.serviceWorker.register('sw.js');
}

</script>
</body>
</html>
